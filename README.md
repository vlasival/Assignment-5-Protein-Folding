# Assignment-5-Protein-Folding

Цель: для **одной белковой последовательности** получить **2 предсказания 3D-структуры (PDB)** разными инструментами (**OpenFold** и **RoseTTAFold2**), затем сравнить их через **парное структурное выравнивание** на сайте RCSB методом **jCE** (Assembly 1, Chain A), визуализировать наложение и сохранить все артефакты.

---

## 1) Input sequence

Последовательность (100 aa):

`MVEYFGQNLNGFLFTKNAWVQSYGTRCVKPPIVWGDVSRANPITVEWSAYAQSKTDHVMKGMLTGPVTILNWSWPREDITHEEQTKQLALAIRDEVLDLE`


---

## 2) Предсказание структур (folding)

### 2.1 RoseTTAFold2
Результаты в папке `RoseTTAFold2/`:

- `RoseTTAFold2/rf2_seed0_00_pred.pdb` — **основной PDB** (предсказанная структура)
- `RoseTTAFold2/msa.a3m` — MSA (выравнивание по гомологам)
- `RoseTTAFold2/rf2_seed0_00.npz` — дополнительные данные/метрики модели
- `RoseTTAFold2/settings.txt` — параметры запуска

### 2.2 OpenFold
Результаты в папке `OpenFold/`.

В качестве основного PDB для сравнения используется **лучший по рангу (rank_001) unrelaxed** из выхода OpenFold (лежит внутри `OpenFold/`).

> Примечание: OpenFold генерирует несколько моделей/рангов; для сравнения берётся rank_001 как лучший по внутреннему ранжированию.

---

## 3) Парное структурное выравнивание (RCSB) — jCE

Инструмент: RCSB Pairwise Structure Alignment  
Метод: **jCE** (Alignment Method)

Сравнивались:
- **OpenFold**: Assembly 1, Chain A
- **RoseTTAFold2**: Assembly 1, Chain A

---

## 4) Экспорт результатов выравнивания и скриншоты

Все результаты RCSB сохранены в папке `allign/`.

### 4.1 Exports (то, что скачано через кнопку Export)
- `allign/exports/structures_2025-12-26-16-29-8/` — экспортированные структуры (координаты/наложение)
- `allign/exports/sequence_alignment_2025-12-26-...` — файл последовательного выравнивания (как выгрузил RCSB)
- `allign/exports/transformation_matrices_2025-12-...` — матрицы преобразования/суперпозиции (выход jCE)

### 4.2 Screens (визуализация и подтверждение результата)
- `allign/screens/screen_rcsb.png` — скрин страницы RCSB с метриками
- `allign/screens/view.png` — общий вид наложения в 3D viewer
- `allign/screens/first_chain.png` — визуализация первой структуры/цепи
- `allign/screens/second_chain.png` — визуализация второй структуры/цепи

---

## 5) Краткий вывод

OpenFold и RoseTTAFold2 дали различающиеся предсказания для одной и той же короткой последовательности: после структурного выравнивания методом jCE совпадает лишь часть остатков, и визуально наблюдаются заметные расхождения в конформации (особенно в гибких участках/петлях и на концах цепи). Сохранённые скриншоты и экспорт RCSB позволяют воспроизвести наложение и проверить метрики.

Полученные расхождения между предсказаниями OpenFold и RoseTTAFold2 являются допустимыми, поскольку методы используют разные архитектуры и пайплайны построения признаков (включая формирование MSA и возможное использование шаблонов), из-за чего оптимизация может сходиться к разным вариантам структуры. Для короткой последовательности (~100 aa) особенно чувствительны к ошибкам и стохастике гибкие области — петли и терминальные участки, которые часто моделируются с меньшей уверенностью и сильнее расходятся между алгоритмами.